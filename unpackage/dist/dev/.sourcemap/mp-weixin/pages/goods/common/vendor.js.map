{"version":3,"sources":["uni-app:///pages/goods/components/lottery/js/grids_lottery.js","uni-app:///api/lottery.js"],"names":["LotteryDraw","obj","callback","timer","startIndex","count","winingIndex","totalCount","speed","domData","rollFn","prototype","that","length","setTimeout","clearInterval","module","exports","getLotteryData","type","request","get","startLottery","data","post","receiveLottery","getLotteryList"],"mappings":";;;;;;;;;AACA,SAASA,WAAW,CAACC,GAAG,EAAEC,QAAQ,EAAE;EACnC,IAAI,CAACC,KAAK,GAAG,IAAI,CAAC,CAAC;EACnB,IAAI,CAACC,UAAU,GAAGH,GAAG,CAACG,UAAU,GAAC,CAAC,IAAI,CAAC,CAAC,CAAC;EACzC,IAAI,CAACC,KAAK,GAAG,CAAC,CAAC,CAAC;EAChB,IAAI,CAACC,WAAW,GAAGL,GAAG,CAACK,WAAW,IAAI,CAAC,CAAC;EACxC,IAAI,CAACC,UAAU,GAAGN,GAAG,CAACM,UAAU,IAAI,CAAC,CAAC;EACtC,IAAI,CAACC,KAAK,GAAGP,GAAG,CAACO,KAAK,IAAI,GAAG;EAC7B,IAAI,CAACC,OAAO,GAACR,GAAG,CAACQ,OAAO;EACxB,IAAI,CAACC,MAAM,EAAE;EACb,IAAI,CAACR,QAAQ,GAAGA,QAAQ;AACzB;AAEAF,WAAW,CAACW,SAAS,GAAG;EACvBD,MAAM,EAAE,kBAAW;IAClB,IAAIE,IAAI,GAAG,IAAI;IACf;IACA;IACA,IAAI,CAACR,UAAU,EAAE;;IAEjB;IACA,IAAI,IAAI,CAACA,UAAU,IAAI,IAAI,CAACK,OAAO,CAACI,MAAM,GAAG,CAAC,EAAE;MAC/C,IAAI,CAACT,UAAU,GAAG,CAAC;MACnB,IAAI,CAACC,KAAK,EAAE;IACb;;IAEA;IACA,IAAI,IAAI,CAACA,KAAK,IAAI,IAAI,CAACE,UAAU,IAAI,IAAI,CAACH,UAAU,KAAK,IAAI,CAACE,WAAW,EAAE;MAC1E,IAAI,OAAO,IAAI,CAACJ,QAAQ,KAAK,UAAU,EAAE;QACxCY,UAAU,CAAC,YAAW;UACrBF,IAAI,CAACV,QAAQ,CAACU,IAAI,CAACR,UAAU,EAACQ,IAAI,CAACP,KAAK,CAAC,CAAC,CAAC;QAC5C,CAAC,EAAE,GAAG,CAAC;MACR;MACAU,aAAa,CAAC,IAAI,CAACZ,KAAK,CAAC;IAC1B,CAAC,MAAK;MAAE;MACP,IAAI,IAAI,CAACE,KAAK,IAAI,IAAI,CAACE,UAAU,GAAG,CAAC,EAAE;QACtC,IAAI,CAACC,KAAK,IAAI,EAAE;MACjB;MACA,IAAI,CAACL,KAAK,GAAGW,UAAU,CAAC,YAAW;QAClCF,IAAI,CAACV,QAAQ,CAACU,IAAI,CAACR,UAAU,EAACQ,IAAI,CAACP,KAAK,CAAC;QACzCO,IAAI,CAACF,MAAM,EAAE;MACd,CAAC,EAAE,IAAI,CAACF,KAAK,CAAC;IACf;EACD;AACD,CAAC;AAEDQ,MAAM,CAACC,OAAO,GAAGjB,WAAW,C;;;;;;;;;;;;;;;;;;;;;;ACpC5B;AAVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACO,SAASkB,cAAc,CAACC,IAAI,EAAE;EACpC,OAAOC,gBAAO,CAACC,GAAG,2BAAoBF,IAAI,EAAG;AAC9C;;AAEA;AACA;AACA;AACA;AACO,SAASG,YAAY,CAACC,IAAI,EAAE;EAClC,OAAOH,gBAAO,CAACI,IAAI,eAAeD,IAAI,CAAC;AACxC;;AAEA;AACA;AACA;AACA;AACO,SAASE,cAAc,CAACF,IAAI,EAAE;EACpC,OAAOH,gBAAO,CAACI,IAAI,uBAAuBD,IAAI,CAAC;AAChD;;AAEA;AACA;AACA;AACA;AACO,SAASG,cAAc,CAACH,IAAI,EAAE;EACpC,OAAOH,gBAAO,CAACC,GAAG,sBAAsBE,IAAI,CAAC;AAC9C,C","file":"pages/goods/common/vendor.js","sourcesContent":["\nfunction LotteryDraw(obj, callback) {\n\tthis.timer = null; //计时器\n\tthis.startIndex = obj.startIndex-1 || 0; //从第几个位置开始抽奖 [默认为零]\n\tthis.count = 0; //计数，跑的圈数\n\tthis.winingIndex = obj.winingIndex || 0;//获奖的位置\n\tthis.totalCount = obj.totalCount || 6;//抽奖跑的圈数\n\tthis.speed = obj.speed || 100;\n\tthis.domData=obj.domData;\n\tthis.rollFn();\n\tthis.callback = callback;\n}\n\nLotteryDraw.prototype = {\n\trollFn: function() {\n\t\tvar that = this;\n\t\t// console.log(`获奖位置：${this.winingIndex}`)\n\t\t// 活动index值增加，即移动到下一个格子\n\t\tthis.startIndex++;\n\t\t\n\t\t//startIndex是最后一个时一圈走完，重新开始\n\t\tif (this.startIndex >= this.domData.length - 1) {\n\t\t\tthis.startIndex = 0;\n\t\t\tthis.count++;\n\t\t}\n\t\t\n\t\t// 当跑的圈数等于设置的圈数，且活动的index值是奖品的位置时停止\n\t\tif (this.count >= this.totalCount && this.startIndex === this.winingIndex) {\n\t\t\tif (typeof this.callback === 'function') {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tthat.callback(that.startIndex,that.count); //执行回调函数，抽奖完成的相关操作\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t\tclearInterval(this.timer);\n\t\t}else { //重新开始一圈\n\t\t\tif (this.count >= this.totalCount - 1) {\n\t\t\t\tthis.speed += 30;\n\t\t\t}\n\t\t\tthis.timer = setTimeout(function() {\n\t\t\t\tthat.callback(that.startIndex,that.count);\n\t\t\t\tthat.rollFn();\n\t\t\t}, this.speed);\n\t\t}\n\t}\n}\n\nmodule.exports = LotteryDraw;","// +----------------------------------------------------------------------\n// | CRMEB [ CRMEB赋能开发者，助力企业发展 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2016~2023 https://www.crmeb.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Licensed CRMEB并不是自由软件，未经许可不能去掉CRMEB相关版权\n// +----------------------------------------------------------------------\n// | Author: CRMEB Team <admin@crmeb.com>\n// +----------------------------------------------------------------------\n\nimport request from \"@/utils/request.js\";\n\n/**\n * 获取抽奖详情信息\n * \n */\nexport function getLotteryData(type) {\n\treturn request.get(`v2/lottery/info/${type}`);\n}\n\n/**\n * 参与抽奖\n * \n */\nexport function startLottery(data) {\n\treturn request.post(`v2/lottery`, data);\n}\n\n/**\n * 领奖\n * \n */\nexport function receiveLottery(data) {\n\treturn request.post(`v2/lottery/receive`, data);\n}\n\n/**\n * 获取中奖记录\n * \n */\nexport function getLotteryList(data) {\n\treturn request.get(`v2/lottery/record`, data);\n}\n"],"sourceRoot":""}